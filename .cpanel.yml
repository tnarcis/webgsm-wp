---
deployment:
  tasks:
    # SeteazÄƒ calea de deploy
    - export DEPLOYPATH=/home2/webgsm/public_html/test/wp-content
    
    # Log pentru debugging
    - echo "=========================================="
    - echo "ğŸš€ WebGSM Deploy Start"
    - echo "=========================================="
    - echo "ğŸ“ Repository: $(pwd)"
    - echo "ğŸ“‚ Deploy to: $DEPLOYPATH"
    - echo "â° Time: $(date)"
    - echo ""
    
    # VerificÄƒ cÄƒ destinaÈ›ia existÄƒ
    - /bin/mkdir -p $DEPLOYPATH/themes
    - /bin/mkdir -p $DEPLOYPATH/plugins
    - echo "âœ… Directories created/verified"
    
    # DEPLOY cu rsync (NU È™terge pÃ¢nÄƒ nu copiazÄƒ cu succes!)
    - echo ""
    - echo "ğŸ“¦ Deploying martfury-child theme..."
    - /usr/bin/rsync -avz --delete --stats wp-content/themes/martfury-child/ $DEPLOYPATH/themes/martfury-child/
    
    - echo ""
    - echo "ğŸ“¦ Deploying webgsm-b2b-pricing plugin..."
    - /usr/bin/rsync -avz --delete --stats wp-content/plugins/webgsm-b2b-pricing/ $DEPLOYPATH/plugins/webgsm-b2b-pricing/
    
    - echo ""
    - echo "ğŸ“¦ Deploying webgsm-checkout-pro plugin..."
    - /usr/bin/rsync -avz --delete --stats wp-content/plugins/webgsm-checkout-pro/ $DEPLOYPATH/plugins/webgsm-checkout-pro/
    
    # Set permissions
    - echo ""
    - echo "ğŸ” Setting permissions..."
    - /bin/chmod -R 755 $DEPLOYPATH/themes/martfury-child
    - /bin/chmod -R 755 $DEPLOYPATH/plugins/webgsm-b2b-pricing
    - /bin/chmod -R 755 $DEPLOYPATH/plugins/webgsm-checkout-pro
    - echo "âœ… Permissions set"
    
    # Verify deployment
    - echo ""
    - echo "ğŸ” Verifying deployed files..."
    - echo "Theme files:"
    - /bin/ls -lah $DEPLOYPATH/themes/martfury-child/ | /bin/head -5
    - echo ""
    - echo "B2B Pricing plugin files:"
    - /bin/ls -lah $DEPLOYPATH/plugins/webgsm-b2b-pricing/ | /bin/head -5
    - echo ""
    - echo "Checkout Pro plugin files:"
    - /bin/ls -lah $DEPLOYPATH/plugins/webgsm-checkout-pro/ | /bin/head -5
    
    # Success message
    - echo ""
    - echo "=========================================="
    - echo "ğŸ‰ DEPLOY COMPLETED SUCCESSFULLY!"
    - echo "=========================================="
    - echo "âš ï¸  IMPORTANT: Clear WordPress cache + browser cache!"
    - echo "âš ï¸  Test site before deploying to production!"
    - echo ""
